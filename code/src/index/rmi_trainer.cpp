// Training pipeline
// Uses least-squares fit